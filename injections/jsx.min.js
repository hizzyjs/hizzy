const[R,R2,T,TIMEOUT,DEV,EXP,STATIC]=$$CONF$$,{CLIENT2SERVER,SERVER2CLIENT}={CLIENT2SERVER:{HANDSHAKE_RESPONSE:"0",CLIENT_FUNCTION_RESPONSE:"1",SERVER_FUNCTION_REQUEST:"2",KEEPALIVE:"3",0:"HANDSHAKE_RESPONSE",1:"SERVER_FUNCTION_REQUEST",2:"CLIENT_FUNCTION_RESPONSE",3:"KEEPALIVE"},SERVER2CLIENT:{FILE_REFRESH:"0",HANDSHAKE_REQUESTED:"1",CLIENT_FUNCTION_REQUEST:"2",SERVER_FUNCTION_RESPONSE:"3",SURE_HANDSHAKE:"4",0:"FILE_REFRESH",1:"HANDSHAKE_REQUESTED",2:"CLIENT_FUNCTION_REQUEST",3:"SERVER_FUNCTION_RESPONSE",4:"SURE_HANDSHAKE"}},w=window,d=document,o=Object,define="defineProperty",key=(delete w.cookieStore,d.querySelector("script[data-rm='"+R+"']").remove(),(document.cookie.split(";").map(e=>e.trim()).find(e=>e.startsWith("__hizzy__="))||"").substring("__hizzy__=".length)),isSecure=(key||location.reload(),"https:"===location.protocol),worker=new Worker(URL.createObjectURL(new Blob(["("+(()=>{let t=new WebSocket("$R");const e=$T;t.addEventListener("open",()=>{0<e&&setInterval(()=>t.send("$P"),e)}),t.addEventListener("close",()=>postMessage(JSON.stringify({event:"close"}))),t.addEventListener("error",()=>postMessage(JSON.stringify({event:"error"}))),t.addEventListener("message",e=>postMessage(JSON.stringify({event:"message",data:e.data}))),addEventListener("message",e=>t.send(e.data))}).toString().replace("$R","ws"+(isSecure?"s":"")+"://"+location.host).replace("$P",CLIENT2SERVER.KEEPALIVE).replace("$T",TIMEOUT)+")()"]))),sendToSocket=e=>worker.postMessage(e);let onRender,renderPromise=new Promise(e=>onRender=e),firstRender=!0;worker.addEventListener("message",async e=>{var t=JSON.parse(e.data);switch(t.event){case"close":case"error":location.reload();break;case"message":var o=t.data.toString();if(o[0]===SERVER2CLIENT.FILE_REFRESH&&(pageCache={},await reloadPage()),o[0]===SERVER2CLIENT.HANDSHAKE_REQUESTED&&onHandshook(),o[0]===SERVER2CLIENT.CLIENT_FUNCTION_REQUEST){await renderPromise;var a=o.substring(1).split(":"),r=a[0],a=a.slice(1).join(":");try{var n=runCode(a,[[`__hizzy_run${R}__`,clientFunctions]]);sendToSocket(CLIENT2SERVER.CLIENT_FUNCTION_RESPONSE+"0"+r+":"+JSON.stringify(n))}catch(e){console.error(e),sendToSocket(CLIENT2SERVER.CLIENT_FUNCTION_RESPONSE+"1"+r+":"+e.message)}}o[0]===SERVER2CLIENT.SERVER_FUNCTION_RESPONSE&&(n=(a=o.substring(1).split(":"))[0],r=a.slice(1).join(":"),evalResponses[n]("undefined"===r?void 0:JSON.parse(r))),o[0]===SERVER2CLIENT.SURE_HANDSHAKE&&onHandshookSure()}});let onHandshook,onHandshookSure;const handshookPromise=new Promise(e=>onHandshook=e),handshookSurePromise=new Promise(e=>onHandshookSure=e);let loadPromise=new Promise(e=>addEventListener("load",e)),clientFunctions={},_evalId=0;const evalResponses={},runCode=(e,t=[],o=!1)=>Function(...t.map(e=>e[0]),(o?"return (async()=>{":"")+e+(o?"})()":""))(...t.map(e=>e[1])),runModuleCode=e=>import(URL.createObjectURL(new Blob([e],{type:"application/javascript"})));await handshookPromise,"complete"!==document.readyState&&await loadPromise,sendToSocket(CLIENT2SERVER.HANDSHAKE_RESPONSE);let mainFile=null,files=null,exports={},hasExported=[],fetchCache={};await handshookSurePromise;const Hizzy={},__hooks=await import("http"+(isSecure?"s":"")+"://"+location.host+"/"+EXP+"/__hizzy__preact__hooks__"),__react=__hooks.React,react=(__react||location.reload(),__react),ADDONS=(Object.assign(Hizzy,__react,__hooks),await(await fetch("/"+R2+"/__hizzy__addons__")).json()),pathJoin=(d.cookie="__hizzy__=; expires=Thu, 01 Jan 1970 00:00:00 UTC;",(e,t=mainFile.split("/").slice(0,-1))=>{var o=[...t];for(const a of e.split("/"))"."!==a&&a&&(".."===a?o.pop():o.push(a));return o.join("/")}),htmlToReact=e=>{e=(new DOMParser).parseFromString(e,"text/html");const n=e=>{if(e instanceof Text)return e.textContent;var t={},o=e.attributes;for(let e=0;e<o.length;e++){var a=o[e];t[a.name.toLowerCase()]=a.value}const r=[];return e.childNodes.forEach(e=>r.push(n(e))),react.createElement(e.tagName.toLowerCase(),{...t},...r)},t=[];return e.childNodes.forEach(e=>t.push(n(e))),()=>react.createElement(react.Fragment,null,...t)},fileHandlers={build:{html:(e,t)=>(exports[e]={default:htmlToReact(t)},hasExported.push(e),exports[e]),css:(e,t)=>{var o=document.createElement("style");return o.innerHTML=t,document.head.appendChild(o),exports[e]={default:o},hasExported.push(e),exports[e]},js:async(e,t)=>(exports[e]={default:await runModuleCode(t)},hasExported.push(e),exports[e])},external:{html:(e,t)=>({default:htmlToReact(t)}),css:(e,t)=>{var o=document.createElement("style");return o.innerHTML=t,document.head.appendChild(o),{default:o}},js:(e,t)=>runModuleCode(t),json:(e,t)=>({default:JSON.parse(t)})}},urlExport=(Hizzy.resolvePath=e=>{e=pathJoin(e);for(const a in STATIC){var t=STATIC[a],o=pathJoin(a,[]).replaceAll("\\","/")+"/";if(e.startsWith(o))return t+"/"+e.substring(o.length)}return e},e=>({default:"/"+Hizzy.resolvePath(e)})),import_=async(e,t,o=[])=>{var a=new URLSearchParams(e.includes("?")?e.split("?").slice(1).join("?"):""),r=""===a.get("url"),a=""===a.get("raw");if(r&&a)throw new Error("An import can't have both '?url' and '?raw'!");if("hizzy"===e||"@hizzyjs/types"===e){if(r||a)throw new Error("Cannot use the '?url' or the '?raw' on Hizzy!");return Hizzy}if("react"===e||"preact"===e){if(r||a)throw new Error("Cannot use the '?url' or the '?raw' on React!");return react}if(addonExports[e]){if(r||a)throw new Error("Cannot use the '?url' or the '?raw' on addons!");return{default:addonExports[e]}}if(r)return urlExport(e);r=e.startsWith(".");const n=pathJoin(e),i=files[n]||files[n+".jsx"]||files[n+".tsx"],s=files[n]?n:files[n+".jsx"]?n+".jsx":n+".tsx";var l=s.split("."),l=l.length<=1?"":l[l.length-1];if(!hasExported.includes(s)){if("jsx"!==l&&"tsx"!==l&&i)return a?{default:i,content:i}:(E=fileHandlers.build[l])?(hasExported.push(s),exports[s]=await E(s,i)):urlExport(e);if(void 0===i){if(e.startsWith("https://")||e.startsWith("http://"))return E=fileHandlers.external[l],l=fetchCache[e]=fetchCache[e]??await(await fetch(e)).text(),E?(hasExported.push(s),exports[s]=a?{default:l,content:l}:await E(s,l)):a?{default:l,content:l}:urlExport(e);{var c,E="http"+(isSecure?"s":"")+"://"+location.host+"/"+(r?n:"__hizzy__npm__/"+files[t].importList.find(e=>e[0]===n.split("/")[0])[1]+"/"+n);d.cookie="__hizzy__="+key;let e;try{a?(c=await(await fetch(E)).text(),e={default:c,content:c}):(e=await import(E),r||(e=e.default))}catch(e){throw e}finally{d.cookie="__hizzy__=; expires=Thu, 01 Jan 1970 00:00:00 UTC;"}return e}}if(a)throw new Error("Cannot use the '?raw' on JSX/TSX files!");l={normal:{},load:{},navigate:{}};await runCode(i.code+";"+(e===mainFile?[["client","normal"],["clientLoad","load"],["clientNavigate","navigate"]].map(t=>i[t[0]].map(e=>`__hizzy_get${R}__.${t[1]}.${e}=typeof ${e}!="undefined"&&${e};`).join("")).join(""):""),[["R"+R2,(...e)=>react.createElement(...e)],["F"+R2,(...e)=>react.Fragment(...e)],["H"+R2,Hizzy],["currentWebSocket",WebSocket],["FN"+R2,t=>(...e)=>runServerFunction(s,t,e)],...e===mainFile?[["__hizzy_get"+R+"__",l]]:[],...o],!0),clientFunctions[s]=l,hasExported.push(s)}return exports[s]};o[define](Hizzy,"E"+R2,{get:()=>exports}),o[define](Hizzy,"I"+R2,{get:()=>(e,t)=>import_(e,t)});for(const f in files)exports[f]={};const runServerFunction=(e,t,o)=>{const a=++_evalId;if(sendToSocket(CLIENT2SERVER.SERVER_FUNCTION_REQUEST+""+a+":"+e+":"+t+":"+JSON.stringify(o)),files[e].respondFunctions.includes(t))return new Promise(e=>evalResponses[a]=e)},addonExports={},doAddon=async(index,...a)=>{for(let i=0;i<ADDONS.length;i++){const addon=ADDONS[i],f=addon[index];if(f){const fn=await eval(f),v=fn(...a);1===index&&(addonExports[addon[0]]=v)}}},_setInterval=(Hizzy.useAddon=e=>addonExports[e]||{},await doAddon(1),window.setInterval),_setTimeout=window.setTimeout;let timeouts=[],pageCache=(window.setTimeout=(e,t)=>{e=_setTimeout(e,t);return timeouts.push(e),e},window.setInterval=(e,t)=>{e=_setInterval(e,t);return timeouts.push(e),e},{[location.pathname]:{mainFile:mainFile,files:files}});const fetchPage=async(e,t=!0)=>{var o=(e=pathJoin(e,location.pathname.split("/").slice(1,-1))).split("#")[0].split("?")[0];d.cookie="__hizzy__="+key;try{if(pageCache[o]){var a=pageCache[o];mainFile=a.mainFile,files=a.files,await fetch("/"+e,{headers:{"hizzy-dest":"script","hizzy-cache":"yes"}})}else{var r=(await(await fetch("/"+e,{headers:{"hizzy-dest":"script"}})).text()).split("\0");if(1===r.length){try{var n=JSON.parse(r[0]);console.error(n.error||n)}catch(e){console.error("Couldn't parse invalid JSON."),console.error(e)}return}mainFile=JSON.parse(r[0]),files=JSON.parse(r.slice(1).join("\0"))}}catch(e){throw e}finally{d.cookie="__hizzy__=; expires=Thu, 01 Jan 1970 00:00:00 UTC;"}exports={},hasExported=[],fetchCache={};for(const i in files)exports[i]={};pageCache[o]={mainFile:mainFile,files:files},t&&(history.pushState({["__hizzy"+R+"__"]:e},null,"/"+e),console.log("%cNavigated to "+location.href,"color: #4c88ff")),await loadPage(mainFile)},reloadPage=()=>fetchPage(location.pathname);Hizzy.fetch=async(e,t={})=>(await fetch(e,t))[t.json?"json":"text"](),Hizzy.openPage=e=>fetchPage(e),Hizzy.reloadPage=()=>reloadPage(),Hizzy.LinkComponent=e=>{const t=(e=e||{}).path||"";return delete e.path,react.createElement("span",{onClick:()=>fetchPage(t),className:"Link",...e},e.children)},addEventListener("popstate",async e=>{await fetchPage(e.state["__hizzy"+R+"__"],!1)});let oldEnds={};const loadPage=async t=>{firstRender||(renderPromise=new Promise(e=>onRender=e)),Object.values(oldEnds).forEach(e=>e()),oldEnds={},firstRender=!1,d.documentElement.innerHTML="";for(const e of timeouts)clearTimeout(e);timeouts=[];try{var o=await import_(t.split("/").slice(-1)[0],null);if(o&&o.default){let e=o.default;if((e="function"==typeof e?react.h(e,null):e).__v){react.render(e,d.body);var a=clientFunctions[t].load;oldEnds=clientFunctions[t].navigate;for(const r in a)a[r]()}}}catch(e){console.error("An error occurred while rendering the file: "+t),console.error(e),await doAddon(3,e)}await doAddon(2),onRender()};await fetchPage(location.pathname,!1);