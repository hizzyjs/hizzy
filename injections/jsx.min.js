const[R,R2,TIMEOUT,DEV,EXP,STATIC]=$$CONF$$,{CLIENT2SERVER,SERVER2CLIENT}={CLIENT2SERVER:{HANDSHAKE_RESPONSE:"0",CLIENT_FUNCTION_RESPONSE:"1",SERVER_FUNCTION_REQUEST:"2",KEEPALIVE:"3",0:"HANDSHAKE_RESPONSE",1:"SERVER_FUNCTION_REQUEST",2:"CLIENT_FUNCTION_RESPONSE",3:"KEEPALIVE"},SERVER2CLIENT:{FILE_REFRESH:"0",HANDSHAKE_REQUESTED:"1",CLIENT_FUNCTION_REQUEST:"2",SERVER_FUNCTION_RESPONSE:"3",SURE_HANDSHAKE:"4",PAGE_PAYLOAD:"5",0:"FILE_REFRESH",1:"HANDSHAKE_REQUESTED",2:"CLIENT_FUNCTION_REQUEST",3:"SERVER_FUNCTION_RESPONSE",4:"SURE_HANDSHAKE",5:"PAGE_PAYLOAD"}},w=window,d=document,o=Object,WK=o.keys(w),key=(delete w.cookieStore,d.querySelector("script[data-rm='"+R+"']").remove(),(document.cookie.split(";").map(e=>e.trim()).find(e=>e.startsWith("__hizzy__="))||"").substring("__hizzy__=".length)),isSecure=(key||location.reload(),"https:"===location.protocol),worker=new Worker(URL.createObjectURL(new Blob(["("+(()=>{let t=new WebSocket("$R");const e=$T,a=$P;t.addEventListener("open",()=>{0<e&&setInterval(()=>{console.debug("> "+a),t.send(a.toString())},e)}),t.addEventListener("close",()=>{console.debug("closed"),postMessage(JSON.stringify({event:"close"}))}),t.addEventListener("error",e=>{console.debug("error",e),postMessage(JSON.stringify({event:"error"}))}),t.addEventListener("message",e=>{console.debug("<",e.data),postMessage(JSON.stringify({event:"message",data:e.data}))}),addEventListener("message",e=>{console.debug("> "+e.data),t.send(e.data)})}).toString().replace("$R","ws"+(isSecure?"s":"")+"://"+location.host).replace("$P",CLIENT2SERVER.KEEPALIVE).replace("$T",TIMEOUT)+")()"]))),sendToSocket=e=>worker.postMessage(e);let onRender,renderPromise=new Promise(e=>onRender=e),firstRender=!0;const expecting={},expectPayload=async(t,e,a)=>(expecting[t]=[null,e,a],new Promise(e=>expecting[t][0]=e)),messageHandler={[SERVER2CLIENT.FILE_REFRESH]:async()=>{pageCache={},await reloadPage()},[SERVER2CLIENT.HANDSHAKE_REQUESTED]:async()=>onHandshook(),[SERVER2CLIENT.CLIENT_FUNCTION_REQUEST]:async e=>{await renderPromise;var e=e.split(":"),t=e[0],e=e.slice(1).join(":");try{var a=runCode(e,[[`__hizzy_run${R}__2`,serverEvaluators],[`__hizzy_run${R}__`,clientFunctions]]);sendToSocket(CLIENT2SERVER.CLIENT_FUNCTION_RESPONSE+"0"+t+":"+JSON.stringify(a))}catch(e){console.error(e),sendToSocket(CLIENT2SERVER.CLIENT_FUNCTION_RESPONSE+"1"+t+":"+e.message)}},[SERVER2CLIENT.SERVER_FUNCTION_RESPONSE]:async e=>{var e=e.split(":"),t=e[0],e=e.slice(1).join(":");evalResponses[t]("undefined"===e?void 0:JSON.parse(e))},[SERVER2CLIENT.PAGE_PAYLOAD]:async e=>{e=e.split("\0");if(1===e.length)try{var t=JSON.parse(e[0]);console.error(t.error||t)}catch(e){console.error("Couldn't parse invalid JSON."),console.error(e)}else{mainFile=JSON.parse(e[0]),files=JSON.parse(e.slice(2).join("\0"));t=expecting[e[1]];Array.isArray(t)&&"function"==typeof t[0]&&t[0](),e[1]||onHandshookSure()}}};worker.addEventListener("message",async e=>{var t=JSON.parse(e.data);switch(t.event){case"close":case"error":location.reload();break;case"message":var a=t.data.toString(),o=messageHandler[a[0]];o&&o(a.substring(1))}});let onHandshook,onHandshookSure;const handshookPromise=new Promise(e=>onHandshook=e),handshookSurePromise=new Promise(e=>onHandshookSure=e);let loadPromise=new Promise(e=>addEventListener("load",e)),_evalId=0;const evalResponses={},runCode=(e,t=[],a=!1)=>Function(...t.map(e=>e[0]),(a?"return (async()=>{":"")+e+(a?"})()":""))(...t.map(e=>e[1])),runModuleCode=e=>import(URL.createObjectURL(new Blob([e],{type:"application/javascript"})));await handshookPromise,"complete"!==document.readyState&&await loadPromise,sendToSocket(CLIENT2SERVER.HANDSHAKE_RESPONSE);let mainFile=null,files=null,exports={},hasExported=[],fetchCache={},clientFunctions={},serverEvaluators={};await handshookSurePromise;const Hizzy={},__hooks=await import("http"+(isSecure?"s":"")+"://"+location.host+"/"+EXP+"/__hizzy__preact__hooks__"),__react=__hooks.React,react=(__react||location.reload(),{}),ADDONS=(o.assign(Hizzy,__react,__hooks),o.assign(react,__react,__hooks),await(await fetch("/"+R2+"/__hizzy__addons__")).json()),rst=()=>d.cookie="__hizzy__=; expires=Thu, 01 Jan 1970 00:00:00 UTC;",stb=()=>d.cookie="__hizzy__="+key,pathJoin=(rst(),(e,t=mainFile.split("/").slice(0,-1))=>{var a=[...t];for(const o of e.split("/"))"."!==o&&o&&(".."===o?a.pop():a.push(o));return a.join("/")}),fileHandlers={build:{html:(e,t)=>({default:(new DOMParser).parseFromString(t,"text/html")}),css:(e,t)=>{var a=document.createElement("style");return a.innerHTML=t,document.head.appendChild(a),{default:a}},js:async(e,t)=>({default:await runModuleCode(t)})},assets:{},external:{html:(e,t)=>({default:(new DOMParser).parseFromString(t,"text/html")}),css:(e,t)=>{var a=document.createElement("style");return a.innerHTML=t,document.head.appendChild(a),{default:a}},js:(e,t)=>runModuleCode(t),json:(e,t)=>({default:JSON.parse(t)})}},urlExport=(Hizzy.sendNavigationMessage=!0,Hizzy.resolvePath=e=>{e=pathJoin(e);for(const o in STATIC){var t=STATIC[o],a=pathJoin(o,[]).replaceAll("\\","/")+"/";if(e.startsWith(a))return t+"/"+e.substring(a.length)}return e},e=>"/"+Hizzy.resolvePath(e)),customExports={hizzy:()=>Hizzy,"@hizzyjs/types":()=>Hizzy,react:()=>react,preact:()=>react},import_=async(t,a,e=[])=>{var o=new URLSearchParams(t.includes("?")?t.split("?").slice(1).join("?"):""),r=""===o.get("url"),o=""===o.get("raw");if(r&&o)throw new Error("An import can't have both '?url' and '?raw'!");var s=customExports[t]&&await customExports[t]()||addonExports[t];if(s){if(r||o)throw new Error("Cannot use the '?url' or the '?raw' on the import '"+t+"'!");return s}if(r)return urlExport(t);s=t.startsWith(".");const n=pathJoin(t.split("?")[0].split("#")[0]);let i=n;for(const u of["tsx","jsx","ts","js"])files[i]||(i=n+"."+u);var r=files[i],l=i.split("."),l=l.length<=1?"":l[l.length-1],c=n.split("."),c=c.length<=1?"":c[c.length-1];if(!hasExported.includes(i)){if("jsx"!==l&&"tsx"!==l&&r)return o?{default:r,content:r}:(l=fileHandlers.build[c])?(hasExported.push(i),exports[i]=await l(i,r)):urlExport(t);if(void 0===r){if(t.startsWith("https://")||t.startsWith("http://"))return l=fileHandlers.external[c],E=fetchCache[t]=fetchCache[t]??await(await fetch(t)).text(),l?(hasExported.push(i),exports[i]=o?{default:E,content:E}:await l(i,E)):o?{default:E,content:E}:urlExport(t);{l=(files[a].importList.find(e=>e[0]===n.split("/")[0])||[])[1];if(!s&&!l)throw new Error("Module not found: "+n);var d,E="http"+(isSecure?"s":"")+"://"+location.host+"/"+(s?n:"__hizzy__npm__/"+l+"/"+n);let e;try{stb(),d=await fetch(E,{headers:{"sec-fetch-dest":"script"}}),rst();var h,p=fetchCache[t]=fetchCache[t]??await d.text();if("application/javascript"!==d.headers.get("Content-Type").split(";")[0].trim())return(h=fileHandlers.assets[c])?(hasExported.push(i),exports[i]=o?{default:p,content:p}:await h(i,p)):o?{default:p,content:p}:urlExport(t);o?e={default:p,content:p}:(e=await runModuleCode(p),s||(e=e.default))}catch(e){throw e}finally{rst()}return e}}if(o)throw new Error("Cannot use the '?raw' on JSX/TSX files!");a={normal:{},load:{},navigate:{}};await runCode(r.code,[["exports",exports[i]],["require",e=>import_(e,i)],["R"+R2,(...e)=>react.createElement(...e)],["F"+R2,(...e)=>react.Fragment(...e)],["H"+R2,Hizzy],["currentWebSocket",WebSocket],["CFN"+R2,a],["SRH"+R2,(e,t)=>serverEvaluators[e]=t],["FN"+R2,(e,t,a)=>{const o=++_evalId;if(sendToSocket(CLIENT2SERVER.SERVER_FUNCTION_REQUEST+""+o+":"+i+":"+e+":"+JSON.stringify([t,a||[]])),files[i].respondFunctions.includes(e))return new Promise(e=>evalResponses[o]=e)}],...e],!0),clientFunctions[i]=a,hasExported.push(i)}return exports[i]};for(const f in files)exports[f]={};const addonExports={},doAddon=async(index,...a)=>{for(let i=0;i<ADDONS.length;i++){const addon=ADDONS[i],f=addon[index];if(f){const fn=await eval(f),v=fn(...a);1===index&&(addonExports[addon[0]]=v)}}},_setInterval=(Hizzy.useAddon=e=>addonExports[e]||{},await doAddon(1),window.setInterval),_setTimeout=window.setTimeout;let timeouts=[],pageCache=(window.setTimeout=(e,t)=>{e=_setTimeout(e,t);return timeouts.push(e),e},window.setInterval=(e,t)=>{e=_setInterval(e,t);return timeouts.push(e),e},{[location.pathname]:{mainFile:mainFile,files:files}});const completePage=async(e,t)=>{var a=e.split("?")[0].split("#")[0];pageCache[a]={mainFile:mainFile,files:files},t&&(history.pushState({["__hizzy"+R+"__"]:e},null,"/"+e),Hizzy.sendNavigationMessage)&&console.log("%c[Hizzy] %cNavigated to "+location.href,"color: orange","color: #4c88ff"),await loadPage(mainFile)},fetchPage=async(e,t=!0)=>{var a,o,r,s=(e=pathJoin(e,location.pathname.split("/").slice(1,-1))).split("?")[0].split("#")[0];try{!DEV&&pageCache[s]?(a=pageCache[s],mainFile=a.mainFile,files=a.files,stb(),await fetch("/"+e,{headers:{"hizzy-dest":"script","hizzy-cache":"yes","hizzy-payload-id":""}}),rst()):(o=crypto.randomUUID(),r=expectPayload(o,e,t),stb(),await fetch("/"+e,{headers:{"hizzy-dest":"script","hizzy-payload-id":o}}),rst(),await r)}catch(e){throw e}finally{rst()}await completePage(e,t)},reloadPage=()=>fetchPage(location.pathname);Hizzy.fetch=async(e,t={})=>(await fetch(e,t))[t.json?"json":"text"](),Hizzy.openPage=e=>fetchPage(e),Hizzy.reloadPage=()=>reloadPage(),Hizzy.LinkComponent=e=>{const t=(e=e||{}).path||"";return delete e.path,react.createElement("span",{onClick:()=>fetchPage(t),className:"Link",...e},e.children)},addEventListener("popstate",async e=>{await fetchPage(e.state["__hizzy"+R+"__"],!1)});let oldEnds={};const baseHTML=d.documentElement.innerHTML,loadPage=async t=>{firstRender||(renderPromise=new Promise(e=>onRender=e)),o.values(oldEnds).forEach(e=>e()),oldEnds={},firstRender=!1,d.documentElement.innerHTML=baseHTML;for(const e of timeouts)clearTimeout(e);timeouts=[],exports={},hasExported=[],fetchCache={},serverEvaluators={},clientFunctions={};for(const n in files)exports[n]={};try{var a=await import_(t.split("/").slice(-1)[0],null);if(a&&a.default){let e=a.default;"function"==typeof e&&(e=react.h(e,null));var r=d.querySelector("main")||d.body;if(e.__v){react.render(e,r);var s=clientFunctions[t].load;oldEnds=clientFunctions[t].navigate;for(const i in s)s[i]()}}}catch(e){console.error("An error occurred while rendering the file: "+t),console.error(e),await doAddon(3,e)}await doAddon(2),onRender()};await completePage("",!1);